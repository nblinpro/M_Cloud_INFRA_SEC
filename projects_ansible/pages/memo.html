<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mémo Lab Ansible | Nicolas Infra</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        main {
            max-width: 900px;
            margin: auto;
            padding: 2rem;
        }

        /* Badges de configuration rapide */
        .lab-info {
            display: flex;
            gap: 15px;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .info-badge {
            background: #1e293b;
            border: 1px solid var(--accent);
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Amélioration du diagramme */
        .diagram-container {
            text-align: center;
            margin: 3rem 0;
            padding: 2rem;
            background-color: #0f172a;
            border-radius: 12px;
            border: 1px solid #334155;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .diagram-container img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            filter: drop-shadow(0 0 10px rgba(59, 130, 246, 0.2));
        }

        .diagram-caption {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #94a3b8;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .step-title {
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--accent);
        }

        pre {
            background: #0f172a !important;
            border: 1px solid #334155;
            padding: 1.2rem;
            border-radius: 8px;
            font-size: 0.9rem;
            margin: 1rem 0;
        }

        code {
            color: #f472b6;
        }

        /* Rose pour les fichiers cités */
    </style>
</head>

<body>

    <header>
        <div class="logo">Nicolas<span>.infra</span></div>
        <nav>
            <ul>
                <li><a href="../../index.html">Accueil</a></li>
                <li><a href="../projets_ansible.html">Projets</a></li>
                <li><a href="mailto:nicolas.blin.pro1@gmail.com" class="btn btn-primary">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero-small">
            <h1>Fiche Mémo : Lab Ansible</h1>
            <p>Mise en place d'un environnement hybride : Contrôleur Ubuntu & Cibles RHEL 9.</p>
        </section>

        <div class="lab-info">
            <div class="info-badge"><i class="fab fa-ubuntu" style="color:#E95420"></i> Control: Ubuntu 22.04+</div>
            <div class="info-badge"><i class="fab fa-redhat" style="color:#EE0000"></i> Cibles: RHEL 9.x</div>
            <div class="info-badge"><i class="fas fa-network-wired"></i> Réseau: 192.168.80.0/24</div>
        </div>

        <section class="doc-section">
            <h2 class="step-title"><i class="fas fa-desktop"></i> 1. Préparation du Contrôleur</h2>

            <h3>A. Configuration IP (Netplan)</h3>
            <p>Édition du fichier <code>/etc/netplan/50-cloud-init.yaml</code> :</p>
            <pre>
network:
  version: 2
  ethernets:
    ens33:
      dhcp4: false
      addresses: [192.168.80.X/24]
      routes:
        - to: default
          via: 192.168.80.2
      nameservers:
        addresses: [8.8.8.8, 1.1.1.1]</pre>
            <pre>sudo netplan apply</pre>

            <h3>B. Installation & SSH</h3>
            <pre>
sudo apt update && sudo apt install ansible -y
ssh-keygen -t rsa -b 4096 <span style="color:#64748b"># Génère ~/.ssh/id_rsa</span></pre>
        </section>

        <hr style="border: 0; border-top: 1px solid #334155; margin: 3rem 0;">

        <section class="doc-section">
            <h2 class="step-title"><i class="fas fa-server"></i> 2. Préparation des serveurs RHEL 9</h2>

            <h3>A. IP Statique & NMCLI</h3>
            <p>Config via <code>nmcli</code> ou édition directe du fichier <code>.nmconnection</code> :</p>
            <pre>
[ipv4]
method=manual
address1=192.168.80.X/24
gateway=192.168.80.2
dns=8.8.8.8;1.1.1.1;</pre>

            <h3>B. Enregistrement & Update</h3>
            <pre>
sudo subscription-manager register
sudo subscription-manager repos --enable=rhel-9-for-x86_64-baseos-rpms
sudo dnf update -y</pre>

            <h3>C. Privilèges Sudo</h3>
            <p>Pour permettre l'automatisation sans mot de passe :</p>
            <pre>innosys ALL=(ALL) NOPASSWD: ALL</pre>
        </section>

        <div class="diagram-container">
            <img src="../images/memo.png" alt="Architecture Lab">
            <div class="diagram-caption"><i class="fas fa-project-diagram"></i> Architecture Logique du Laboratoire
            </div>
        </div>

        <section class="doc-section">
            <h2 class="step-title"><i class="fas fa-check-double"></i> 3. Connexion</h2>
            <p>Depuis le contrôleur, envoyer la clé pour valider la confiance SSH :</p>
            <pre>
ssh-copy-id innosys@192.168.80.X
ssh innosys@192.168.80.X <span style="color:#64748b"># Test de connexion directe</span></pre>
        </section>

    </main>

    <footer>
        <p>© 2025 Nicolas Blin | <a href="../projets_ansible.html" style="color:var(--accent)">← Retour au projet</a>
        </p>
    </footer>

</body>

</html>
