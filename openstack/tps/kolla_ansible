sudo nano /etc/netplan/50-cloud-init.yaml
network:
  version: 2
  ethernets:
    ens33:
      dhcp4: false
      dhcp6: false
      accept-ra: false
      addresses: [192.168.80.182/24]
      nameservers:
        addresses: [8.8.8.8]
      routes:
      - to: default
        via: 192.168.80.2
    ens34:
      dhcp4: false
      dhcp6: false
      accept-ra: false
  
  sudo apt update && sudo apt upgrade -y
  python3 -m venv ~/kolla-venv
  source ~/kolla-venv/bin/activate
  pip install -U pip
  pip install docker pkgconfig dbus-python
  sudo apt install libdbus-1-dev libglib2.0-dev build-essential
  pip install git+https://opendev.org/openstack/kolla-ansible@master
  sudo mkdir -p /etc/kolla
  sudo chown $USER:$USER /etc/kolla
  sudo cp -r ~/kolla-venv/share/kolla-ansible/etc_examples/kolla/* /etc/kolla/
  sudo cp kolla-venv/share/kolla-ansible/ansible/inventory/all-in-one
  kolla-ansible install-deps
  kolla-genpwd
  sudo nano /etc/kolla/globals.yml
   ---
workaround_ansible_issue_8743: true
kolla_base_distro: "ubuntu"
kolla_internal_vip_address: "192.168.80.50"
network_interface: "ens33"
neutron_external_interface: "ens34"
enable_cinder: yes
enable_cinder_backend_lvm: yes

  sudo fallocate -l 10G /cinder_data.img
  sudo losetup /dev/loop10 /cinder_data.img
  sudo pvcreate /dev/loop10
  sudo vgcreate cinder-volumes /dev/loop10
  sudo docker pull quay.io/openstack.kolla/keystone:2024.2-ubuntu-noble

  kolla-ansible bootstrap-servers -i ./all-in-one
  kolla-ansible prechecks -i ./all-in-one
  kolla-ansible pull -i ./all-in-one
  kolla-ansible deploy -i ./all-in-one

  pip install python-openstackclient -c https://releases.openstack.org/constraints/upper/master
  kolla-ansible post-deploy -i ./all-in-one
